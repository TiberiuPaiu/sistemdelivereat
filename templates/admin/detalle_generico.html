{% extends 'base/base_adminlte.html' %}
{% load static %}
{% load custom_filters %}
{% block style %}
 <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="{% static 'adminlte/css/all.min.css' %}">
    <!--  iconas fas -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css"
          integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">

    <link rel="stylesheet" href="{% static 'adminlte/css/adminlte.min.css' %}">


{% endblock %}


{% block content %}





            <!-- Contenido de la página -->
            <section class="content">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="card card-primary">
                                <div class="card-header" style="background-color: #969FAA; color:white">
                                    <h3 class="card-title">Detalles del {{ tipo_objeto }}</h3>
                                </div>
                                <div class="card-body">
                                    {% if tipo_objeto == 'restaurante' %}


                                        <p>Nombre: {{ object.nombre }}</p>
                                        <p>Dirección: {{ object.ubicacion.full_address }}</p>
                                        <p>Descripción: {{ object.descripcion }}</p>

                                         <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                                <div class="carousel-inner">
                                    <!-- Aquí puedes iterar sobre las imágenes del restaurante y mostrarlas en el carrusel -->
                                    {% for obj in object.imagens.all %}
                                        <div class="carousel-item {% if forloop.first %}active{% endif %}">
                                            <img class="d-block w-100" style="max-height: 200px; object-fit: cover;" src="{{ obj.imagen.url }}" >
                                        </div>
                                    {% endfor %}
                                </div>
                                <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Previous</span>
                                </a>
                                <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Next</span>
                                </a>
                            </div>


                                        <!-- Agrega más detalles específicos del restaurante -->
                                    {% elif tipo_objeto == 'usuario' %}
                                        <p>Nombre de usuario: {{ object.username }}</p>
                                        <p>Correo electrónico: {{ object.email }}</p>
                                         <p>Nombre: {{ object.get_full_name }}</p>
                                        <p> Telfeono: {{ object.full_telefono }}</p>
                                        <p> Rol: {{ oject.user_type }}</p>
                                        
                                        <!-- Agrega más detalles específicos del pedido -->

                                    {% elif tipo_objeto == 'pedido' %}


                                        <div class="invoice p-3 mb-3">

<div class="row">
<div class="col-12">

<h4>
<img class="img-circle " src="/media/img/icono_app.ico" alt="user image" width="50" height="50" >
DeliverEat
<small class="float-right"> {{ object.fecha_pedido }} </small>
          
</h4>
</div>

</div>

<div class="row invoice-info">
<div class="col-sm-4 invoice-col">

<address>
<strong>{{ object.restaurante.nombre }}</strong><br>

{{ object.restaurante.ubicacion.direcion }} {{ object.restaurante.ubicacion.numero }}<br>
{{ object.restaurante.ubicacion.pais }} {{ object.restaurante.ubicacion.ciudad }}, {{ object.restaurante.ubicacion.codigo_postal }}<br>
Teléfono: {{ object.restaurante.partner.user.full_telefono }} <br>
Correo electrónico:<a href="/cdn-cgi/l/email-protection"  >{{ object.restaurante.partner.user.email }}</a>
</address>
</div>

<div class="col-sm-4 invoice-col">

<address>
<strong>{{ object.cliente.user.get_full_name }}</strong><br>
{{ object.ubicacion.direcion }} {{ object.ubicacion.numero }}<br>
{{ object.ubicacion.pais }} {{ object.ubicacion.ciudad }}, {{ object.restaurante.ubicacion.codigo_postal }}<br>
Teléfono: {{ object.cliente.user.full_telefono }} <br>
Correo electrónico:<a href="/cdn-cgi/l/email-protection"  >{{ object.cliente.user.email }}</a>
</address>
</div>

<div class="col-sm-4 invoice-col">
<b>Pedido #{{ object.codigo_pedido }}</b><br>
<br>
<b>Código de confirmación :</b> {{ object.codigo_validacio }}<br>
<b>Fecha de pago:</b> <br>
<b>Cuenta:</b> 
</div>

</div>


<div class="row">
<div class="col-12 table-responsive">
<table class="table table-striped">
<thead>
<tr>
<th>Unidades</th>
<th>Product</th>

<th>Imagen</th>
<th>Precio unidad</th>
<th>Subtotal</th>
</tr>
</thead>
<tbody>



 {% for pedido_plato in object.pedidoplato_set.all %}
<tr>
<td> {{ pedido_plato.cantidad }} </td>
<td>{{ pedido_plato.plato.nombre }}</td>
<td> <img class="img-circle img-bordered-sm" src="{{pedido_plato.plato.imagen.url}}" alt="user image" width="20%" height="20%" ></td>

<td>    {% if pedido_plato.plato.descuento > 0 %}
            <del>{{ pedido_plato.plato.precio }}</del> -  {{ pedido_plato.plato|descuento }}  € Descuento : {{ pedido_plato.plato.descuento }}%

            {% else %}
               {{ pedido_plato.plato.precio }}  €
            {% endif %}</td>
<td>   {{ pedido_plato.subtotal}} € </td>

</tr>
        {% endfor %}

</tbody>
</table>
</div>

</div>

<div class="row">

<div class="col-5">

</div>



<div class="col-7">
<p class="lead"> Fecha del pedido {{ object.fecha_pedido|date:"d/m/Y" }}</p>
<div class="table-responsive">
<table class="table">
<tr>
<th style="width:50%">Subtotal:</th>
<td>{{ object.total }}  €</td>
</tr>
<tr>
<th>Impuesto Plataforma (10%)</th>
<td>{{  object.total|tax_plat}}  €  </td>
</tr>
<tr>
<th>Impuesto Traferencias (3% + 0,50€):</th>
<td>{{  object.total|tax_trans}} €  </td>
</tr>
<tr>
<th>Total:</th>
<td>{{  object.total|tax_full}} €  </td>
</tr>
</table>
</div>
</div>

</div>


<div class="row no-print">
<div class="col-12"> 
<button   type="button" name="imprimir" value="Imprimir" onclick="window.print();" class="btn btn-default"><i class="fas fa-print"></i> Imprimir </button>
<a href="{% url 'myapp:generar_pdf' id_objeto=object.id tipo_objeto='pedido' %}"> 
<button type="button" class="btn btn-primary float-right" style="margin-right: 5px;" >
<i class="fas fa-download"></i> Generar PDF
</button></a>
</div>
</div>
</div>
                                        
                                        <!-- Agrega más detalles específicos del usuario -->
                                    {% endif %}

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

{% endblock %}

{% block script %}


<!-- jQuery -->
<script src="{% static 'adminlte/js/jquery.min.js' %}"></script>
<!-- Bootstrap 4 -->
<script src="{% static 'adminlte/js/bootstrap.bundle.min.js' %}"></script>


<!-- AdminLTE App -->
<script src="{% static 'adminlte/js/adminlte.min.js' %}"></script>

{% endblock %}
